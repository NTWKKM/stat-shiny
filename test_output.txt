FE..
======================================================================
ERROR: test_logic_integration (__main__.TestDataPipeline.test_logic_integration)
Test integration with logic.analyze_outcome.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/ntwkkm/shiny-stat/stat-shiny/tests/test_data_pipeline.py", line 85, in test_logic_integration
    html_table, or_res, _, _ = analyze_outcome("y", df)
                               ~~~~~~~~~~~~~~~^^^^^^^^^
  File "/Users/ntwkkm/shiny-stat/stat-shiny/utils/logic.py", line 722, in analyze_outcome
    c_all = count_val(X_raw, lbl_txt)
  File "/Users/ntwkkm/shiny-stat/stat-shiny/utils/logic.py", line 655, in count_val
    series.astype(str).apply(
    ~~~~~~~~~~~~~~~~~~~~~~~~^
        lambda x: x.replace(".0", "") if x.replace(".", "", 1).isdigit() else x
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/ntwkkm/shiny-stat/stat-shiny/.venv/lib/python3.14/site-packages/pandas/core/series.py", line 5084, in apply
    ).apply()
      ~~~~~^^
  File "/Users/ntwkkm/shiny-stat/stat-shiny/.venv/lib/python3.14/site-packages/pandas/core/apply.py", line 1520, in apply
    return self.apply_standard()
           ~~~~~~~~~~~~~~~~~~~^^
  File "/Users/ntwkkm/shiny-stat/stat-shiny/.venv/lib/python3.14/site-packages/pandas/core/apply.py", line 1578, in apply_standard
    mapped = obj._map_values(mapper=curried)
  File "/Users/ntwkkm/shiny-stat/stat-shiny/.venv/lib/python3.14/site-packages/pandas/core/base.py", line 1020, in _map_values
    return arr.map(mapper, na_action=na_action)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ntwkkm/shiny-stat/stat-shiny/.venv/lib/python3.14/site-packages/pandas/core/arrays/base.py", line 2692, in map
    return map_array(self, mapper, na_action=na_action)
  File "/Users/ntwkkm/shiny-stat/stat-shiny/.venv/lib/python3.14/site-packages/pandas/core/algorithms.py", line 1710, in map_array
    return lib.map_infer(values, mapper)
           ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "pandas/_libs/lib.pyx", line 3071, in pandas._libs.lib.map_infer
  File "/Users/ntwkkm/shiny-stat/stat-shiny/utils/logic.py", line 656, in <lambda>
    lambda x: x.replace(".0", "") if x.replace(".", "", 1).isdigit() else x
                                     ^^^^^^^^^
AttributeError: 'float' object has no attribute 'replace'

======================================================================
FAIL: test_html_report_generation (__main__.TestDataPipeline.test_html_report_generation)
Test HTML report generation.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/Users/ntwkkm/shiny-stat/stat-shiny/tests/test_data_pipeline.py", line 73, in test_html_report_generation
    self.assertIn("20 (16.7%)", html) # Excluded count
    ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^
AssertionError: '20 (16.7%)' not found in '<div class="missing-data-section">\n<h4>ðŸ“Š Missing Data Summary</h4>\n<div style=\'margin-bottom: 15px; font-size: 0.95em; color: #495057;\'>  <div style=\'display:flex; justify-content:space-between; margin-bottom: 8px;\'>    <span><strong>Strategy:</strong> <span style="padding: 2px 6px; border-radius: 4px; font-weight: bold; font-size: 0.85em; display: inline-block; background-color: #e2e3e5; color: #383d41; border: 1px solid #d6d8db;">complete-case</span></span>    <span><strong>Total Rows:</strong> 120</span>  </div>  <div>Included: <b>100</b> (83.3%) | Excluded: <span style=\'color: #dc3545;\'><b>20</b> (16.7%)</span></div></div><h5>Variables with Missing Data:</h5>\n<table class="missing-table">\n<thead><tr><th>Variable</th><th>Type</th><th>N Valid</th><th>N Missing</th><th>% Missing</th></tr></thead>\n<tbody>\n<tr class=\'\'>\n<td>age</td>\n<td>Unknown</td>\n<td>0</td>\n<td>10</td>\n<td>8.3%</td>\n</tr>\n<tr class=\'\'>\n<td>score</td>\n<td>Unknown</td>\n<td>0</td>\n<td>20</td>\n<td>16.7%</td>\n</tr>\n</tbody>\n</table>\n</div>\n'

----------------------------------------------------------------------
Ran 4 tests in 0.281s

FAILED (failures=1, errors=1)
